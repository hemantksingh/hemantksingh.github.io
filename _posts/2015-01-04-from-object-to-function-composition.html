---
layout: post
title: From object to function composition
date: '2015-01-04T11:23:00.000-08:00'
author: Hemant Kumar
tags: 
modified_time: '2015-01-04T11:23:46.244-08:00'
blogger_id: tag:blogger.com,1999:blog-760105884896384612.post-4349618417298701502
blogger_orig_url: http://kodekitab.blogspot.com/2015/01/from-object-to-function-composition.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: left;"><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="background-color: white;"><span style="line-height: 18.2000007629395px;">Composition is a technique often used to build software by creating cohesive units that interact with each other to form the overall system. At the code level these units mainly consist of functions and objects. A system can be built by composing objects with abstractions that define the rules for communication with other objects. An alternative way of building the system is by composing functions and defining the rules of communication through functional contracts (i.e. passing functions into functions). Coming from an object oriented background I feel this second approach is worth exploring further.</span></span></span></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="background-color: white; line-height: 18.2000007629395px;">Using the C#&nbsp;<a href="http://craftsmanship.sv.cmu.edu/exercises/gilded-rose-kata" target="_blank">GildedR<span id="goog_39888737"></span><span id="goog_39888738"></span>ose </a>kata as an&nbsp;example, an</span></span><span style="background-color: white; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'; line-height: 18.2000007629395px;">&nbsp;object oriented way of expressing the quality adjustment in a product looks like this</span></div><div style="text-align: left;"><br /></div><script src="https://gist.github.com/hemantksingh/69e8fd8e5afbc9470bd4.js"></script><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="background-color: white;"><span style="line-height: 18.2000007629395px;">Now I have a couple of issues with the code above. First there is some repetition&nbsp;and unnecessary noise in the code that declares constructors for various IAdjustQuality implementations. Secondly IAdjustQuality and IProduct are single-method interfaces and I am suspicious of interfaces with single methods. I</span></span></span><span style="background-color: white; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'; line-height: 18.2000007629395px;">nterfaces are generally created for a bunch of related methods.</span><br /><br /><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="background-color: white;"><span style="line-height: 18.2000007629395px;">An alternative way to express the quality adjustment in a Product in the GildedRose example would be to compose functions rather than objects. Although C# traditionally has been&nbsp;perceived&nbsp;to be an&nbsp;object oriented language but with lambda expressions it is very much possible to write functional code in C#.&nbsp;</span></span></span><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'; line-height: 18.2000007629395px;">Single-method interfaces are easy to replace with the usage of closures and "function pointers" as long as the function has a compatible signature to the method declared in the single-method interface. Lets see how we can replace IAdjustQuality with its functional equivalent.</span><br /><br /><script src="https://gist.github.com/hemantksingh/066c82b9bf104a95dad5.js"></script><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol'; line-height: 18.2000007629395px;"><br /></span><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="line-height: 18.2000007629395px;">Creating the AdjustQuality and AdjustBackstageQuality functions results in the removal of &nbsp;2 classes and the interface declaration itself. Notice AdjustQuality function uses partial application i.e. it is a function that returns another function. The first function is applied partially to return the actual function. This should be more clear after looking at the Product class now.</span></span><br /><script src="https://gist.github.com/hemantksingh/df9c8c7c4a6723196391.js"></script><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="line-height: 18.2000007629395px;"><br /></span></span><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="line-height: 18.2000007629395px;">Applying the same technique of replacing an interface with its equivalent function pointer the IProduct interface can also be removed and the resulting code looks like this.&nbsp;</span></span><br /><br /><script src="https://gist.github.com/hemantksingh/2ec0223783a99d38675f.js"></script><span style="color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif, Segoe UI Emoji, Segoe UI Symbol;"><span style="background-color: white;"><span style="line-height: 18.2000007629395px;">So why compose functions rather than objects. One of the benefits as you may have noticed straight away is that functional code is pretty&nbsp;succinct and has less lines of code (less than half of the original object oriented approach). The noise around declaring single-method interfaces and their implementations is no more present. However the functional approach might seem confusing and less readable especially the excessive use of lambda expressions and partial application. But I guess depending on whether you come from the object oriented background or the functional one you could sway either way. There is no right or wrong here. The basic idea is how objects and functions can be used to split your overall system into&nbsp;manageable&nbsp;chunks. The flexibility of achieving that in more than one way is a powerful tool to have.</span></span></span></div>